<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, minimal-ui">

    <title>Trump World</title>
    <script type="text/javascript" src="assets/js/jquery/dist/jquery.min.js"></script>
    <script src="assets/css/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>
    <script src="assets/css/bootstrap-material-design/dist/js/material.min.js"></script>
    <script src="assets/css/bootstrap-material-design/dist/js/ripples.min.js"></script>
    <script type="text/javascript" src="assets/js/colaLayoutOptions.js"></script>
    <!-- <script type="text/javascript" src="assets/js/ngraphForceLayoutOptions.js"></script> -->
    <script type="text/javascript" src="assets/js/cytoscape/dist/cytoscape.min.js"></script>
    <script type="text/javascript" src="assets/js/cytoscape-graphml/cytoscape-graphml.js"></script>
    <!-- <script type="text/javascript" src="assets/js/cytoscape-ngraph.forcelayout/cytoscape-ngraph.forcelayout.js"></script> -->
    <script type="text/javascript" src="assets/js/cytoscape-cola/cola.js"></script>
    <script type="text/javascript" src="assets/js/cytoscape-cola/cytoscape-cola.js"></script>
    <script type="text/javascript" src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script type="text/javascript" src="assets/js/graphDataView.js"></script>
    <script type="text/javascript" src="assets/js/slidereveal.js"></script>

    <link href="https://fonts.googleapis.com/css?family=Metrophobic" rel="stylesheet" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
    <link href="assets/css/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="assets/css/bootstrap-3.3.7-dist/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="assets/css/bootstrap-material-design/dist/css/bootstrap-material-design.css">
    <link rel="stylesheet" type="text/css" href="assets/css/bootstrap-material-design/dist/css/ripples.min.css">
    <link href="assets/css/styles.css" rel="stylesheet" />

    <!-- Material Design for Bootstrap -->
    <script>
        $.material.init();

    </script>

</head>

<body>
    <div class="container-fluid">
        <div class="jumbotron">
            <h2 class="title">Mapping The Trump World</h2>
        </div>
        <row>
            <div class="col-md-7 col-lg-7 col-sm-7">
                <div class="card btn-group btn-group-justified">
                    <a href="javascript:void(0)" class="btn " id="graph_viz_btn">Trump World</a>
                    <a href="javascript:void(0)" class="btn " id="adj_matrix_btn">Adjacency Matrix</a>
                    <a href="javascript:void(0)" class="btn " id="rankings_btn">Rankings</a>
                    <a href="javascript:void(0)" class="btn " id="graph_data_btn">Graph Data</a>
                    <a href="javascript:void(0)" class="btn " id="help_btn">Help</a>
                </div>
            </div>
            <div id="trigger" class="col-md-3 col-lg-3 col-sm-3 col-md-offset-2 col-sm-offset-2 col-lg-offset-2">
                <a href="javascript:void(0)" class="card btn btn-danger btn-lg btn-block btn-raised">Analysis</a>    
            </div>
        </row>
        <row id="home">
            <div class="col-md-12 col-lg-12 col-sm-12">
                <div class="panel panel-primary">
                    <div id="cy_container">
                        <div id="cy"></div>
                    </div>

                    <div id="adj_matrix_container">
                        <div id="adj_matrix">
                            
                        </div>
                    </div>

                    <div id="rankings_container">
                        <div id="rankings">
                            Rankings and Adjacency Matrix go here.
                        </div>
                    </div>

                    <div id="graph_data_container">
                        <div id="graph_data">
                            
                        </div>
                    </div>

                    <div id="help_container">
                        <div id="help">
                            Help the user figure this site out.
                        </div>
                    </div>
                </div>
            </div>            
        </row>
    </div>
    <div class="card" id="slider">
        <row class="vertical-align">
            <div class="col-md-2 col-lg-2 col-sm-2">
                <i class="material-icons" style="text-align:left;font-size:40px;border:3px solid #232C96;color:#232C96;">search</i>
            </div>
            <div class="col-md-5 col-lg-5 col-sm-5">
                <div class="form-group label-static has-info">
                    <label for="startNode" class="control-label">Start At</label>
                    <input type="text" class="form-control" id="startNode" style="font-size:14px;color:#111;">
                </div>
            </div>
            <div class="col-md-5 col-lg-5 col-sm-5">
                <div class="form-group label-static has-info">
                    <label for="endNode" class="control-label">End At</label>
                    <input type="text" class="form-control" id="endNode" style="font-size:14px;color:#111;">
                </div>
            </div>
        </row>
        <row class="vertical-align">
            <div class="col-md-2 col-lg-2 col-sm-2">
                <i class="material-icons" style="text-align:left;font-size:40px;border:3px solid #F93324;color:#F93324;">zoom_in</i>
            </div>
            <div class="col-md-9 col-lg-9 col-sm-9">
                <div class="form-group label-static has-error">
                    <label for="focusOn" class="control-label">Focus On</label>
                    <input type="text" class="form-control" id="focusOn" style="font-size:14px;color:#111;">
                </div>
            </div>
        </row>
        <row class="vertical-align">
            <div class="col-md-2 col-lg-2 col-sm-2">
                <i class="fa fa-bullseye" style="padding:0px 4px 0px;text-align:left;font-size:40px;border:3px solid #3F9D2F;color:#3F9D2F;"></i>
            </div>
            <div class="col-md-10 col-lg-10 col-sm-10">
                <div class="form-group label-static has-success">
                    <label for="resizeNodes" class="control-label">Resize Nodes</label>
                    <select id="resizeNodes" class="form-control" style="font-size:14px;color:#111;">
                        <option value="">Select</option>
                        <option value="degree"> Most Connected (Degree) </option>
                        <option value="betweeness"> Most Paths (Betweeness) </option>
                        <option value="closeness"> Most Reach (Closeness) </option>
                    </select>
                </div>
            </div>
        </row>
    </div>

    <script type="text/javascript">
        $(function() {          

            "use strict";
            var win = $(window);

            var graphP = $.ajax({
                url: 'assets/data/trump-world.json',
                type: 'GET',
                dataType: 'json'
            });
            // also get style via ajax
            var styleP = $.ajax({
                url: 'assets/graph-layout-styles.txt',
                type: 'GET',
                dataType: 'text'
            });
            
            // when both graph export json and style loaded, init cy
            Promise.all([graphP, styleP]).then(initCy);

            function initCy(then) {
                console.log("In Init CY");

                var styleJson = then[1];
                var graphElements = then[0];

                console.log(graphElements[0]);
                
                var cy = window.cy = cytoscape({
                    headless: false,
                    styleEnabled: true,
                    container: $("#cy"),
                    elements: graphElements,
                    style: styleJson,
                    layout: layoutOptions,
                    zoom: 0.001,
                    pan: { x: 0, y: 0 },
                    minZoom: 1e-50,
                    maxZoom: 1e50,
                    zoomingEnabled: true,
                    userZoomingEnabled: true,
                    panningEnabled: true,
                    userPanningEnabled: true,
                    boxSelectionEnabled: false,
                    selectionType: 'single',
                    touchTapThreshold: 8,
                    desktopTapThreshold: 4,
                    autolock: false,
                    autoungrabify: false,
                    autounselectify: false,
                    ready: function() {
                        console.log(this.elements()[0]);                        
                        $("#cy_container").height(win.innerHeight() - 130);
                        this.resize();
                        //this.layout(layoutOptions);                        
                    } 

                });
                               

                function resize() {
                    console.log(win.height(), win.innerHeight());
                    $("#cy_container").height(win.innerHeight() - 130);
                    cy.resize();
                }

                win.resize(function() {
                    resize();
                });

                d3.csv('assets/data/org-org-connections.csv',function (data) {
                    var columns = ['Organization A','Organization B','Connection','Source(s)'];
                    tabulate(data,columns);
                });

                $('#slider').slideReveal({
                    trigger: $("#trigger"),
                    position: "right",
                    width: "26%",
                    top: 180,
                    push: false,
                    overlay: true,
                    autoEscape: true                
                });


                /**********************************************************************/
                /*** On Click of Trump World show Cytoscape Container       ***********/

                $("#graph_viz_btn").click(function() {
                    $("#cy_container").show();
                    $("#trigger").show();
                    $("#adj_matrix_container").hide();
                    $("#graph_data_container").hide();
                    $("#help_container").hide();
                    $("#rankings_container").hide();    
                });

                /**********************************************************************/
                /*** On Click of Rankings show Rankings Container           ***********/

                $("#rankings_btn").click(function() {
                    $("#cy_container").hide();
                    $("#trigger").hide();
                    $("#adj_matrix_container").hide();
                    $("#graph_data_container").hide();
                    $("#help_container").hide();
                    $("#rankings_container").show();    
                });

                /**********************************************************************/
                /*** On Click of Description show Description Container           ***********/

                $("#adj_matrix_btn").click(function() {
                    $("#cy_container").hide();
                    $("#trigger").hide();
                    $("#adj_matrix_container").show();
                    $("#graph_data_container").hide();
                    $("#help_container").hide();
                    $("#rankings_container").hide();    
                });

                /**********************************************************************/
                /*** On Click of Graph Data show Graph Data Container           ***********/

                $("#graph_data_btn").click(function() {

                    $("#cy_container").hide();
                    $("#trigger").hide();
                    $("#adj_matrix_container").hide();
                    $("#graph_data_container").show();
                    $("#help_container").hide();
                    $("#rankings_container").hide();

                });

                /**********************************************************************/
                /*** On Click of Help show Help Container           ***********/

                $("#help_btn").click(function() {
                    $("#cy_container").hide();
                    $("#trigger").hide();
                    $("#adj_matrix_container").hide();
                    $("#graph_data_container").hide();
                    $("#help_container").show();
                    $("#rankings_container").hide();    
                });
            }

        });

    </script>
</body>

</html>
